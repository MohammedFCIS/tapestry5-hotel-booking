<!DOCTYPE html>
<html t:type="layout" t:pageTitle="Book your room"
      xmlns:t="http://tapestry.apache.org/schema/tapestry_5_3.xsd"
      xmlns:p="tapestry:parameter">
        <!-- Most of the page content, including <head>, <body>, etc. tags, comes from Layout.tml -->

	<h2>Book hotel room</h2>

    <t:if test="booking">
        <div class="hotel-details" t:type="beandisplay" t:object="booking.hotel" t:exclude="id" t:include="name,address,city,state,zip,country,price,stars">
            <p:stars>
                <t:hotelclass stars="booking?.hotel?.stars" />
            </p:stars>
        </div>


	<t:delegate to="step" />
	
	<t:block t:id="bookBlock">
		<form class="full-form" t:type="form" t:id="bookingForm" t:validate="booking">
			<t:errors />
			<table>
				<tr>
					<th>
						<label t:type="label" t:for="checkinDate">Check In Date</label>
					</th>
					<td>
						<input t:type="datefield" t:id="checkinDate" t:value="booking.checkinDate"/>
					</td>	
				</tr>
				<tr>
					<th>
						<label t:type="label" t:for="checkoutDate">Check Out Date</label>
					</th>
					<td>
						<input t:type="datefield" t:id="checkoutDate" t:value="booking.checkoutDate"/>
					</td>	
				</tr>
				<tr>
					<th>
						<label t:type="label" t:for="roomPreference">Room Preference</label>
					</th>
					<td>
						<select t:type="select" t:id="roomPreference" t:value="booking.beds" t:model="bedType">
						</select>
					</td>	
				</tr>
				<tr>
					<th>
						<label t:type="label" t:for="smoking">Smoking</label>
					</th>
					<td class="inline">
						<t:radiogroup t:id="smoking" t:value="booking.smoking">
							<t:radio t:id="smoke" t:value="literal:true"/>
                			<t:label for="smoke"/>
                			<t:radio t:id="nosmoke" t:value="literal:false"/>
                			<t:label for="nosmoke"/>
                		</t:radiogroup>
					</td>	
				</tr>
				<tr>
					<th>
						<label t:type="label" t:for="creditCardNumber">Credit Card Number</label>
					</th>
					<td>
						<input t:type="textfield" t:id="creditCardNumber" t:value="booking.creditCardNumber"/>
					</td>	
				</tr>
				<tr>
					<th>
						<label t:type="label" t:for="creditCardType">Credit Card Type</label>
					</th>
					<td>
						<select t:type="select" t:id="creditCardType" t:value="booking.creditCardType">
						</select>
					</td>	
				</tr>
				<tr>
					<th>
						<label t:type="label" t:for="creditCardName">Credit Card Name</label>
					</th>
					<td>
						<input t:type="textfield" t:id="creditCardName" t:value="booking.creditCardName"/>
					</td>	
				</tr>
				<tr>
					<th>
						<label t:type="label" t:for="creditCardExpiryYear">Expiration</label>
					</th>
					<td class="inline">
						<select t:type="select" t:id="creditCardExpiryYear" t:value="booking.creditCardExpiryYear" t:model="years"></select>
						&nbsp;
						<select t:type="select" t:id="creditCardExpiryMonth" t:value="booking.creditCardExpiryMonth" t:model="months"></select>
					</td>	
				</tr>				
			</table>
			<div class="form-submit">
				<input type="submit" class="btn-active" value="Book" /> or <a href="#" t:type="eventlink" t:event="cancelBooking">Cancel</a>
			</div>
		</form>
	</t:block>
	
	<t:block t:id="confirmBlock">
		<div class="booking-details" t:type="beandisplay" t:object="booking" t:include="checkinDate,checkoutDate,creditCardNumber,total">
			<p:creditCardNumber>
				#### #### #### ${securedCardNumber}
			</p:creditCardNumber>
		</div>

		<form class="full-form" t:type="form" t:id="confirmForm">
			<t:errors />				
			<div class="form-submit">
				<input type="submit" class="btn-active" value="Confirm" /> or <a href="#" t:type="eventlink" t:event="cancelConfirm">Cancel</a>
			</div>
		</form>

	</t:block>
	 </t:if>
	
	<t:shoppingCart />

	<p:sidebar>
        <p>
            This page (Book.tml/Book.java)
        </p>
        <p>Here we're  using Tapestry's Block element (&lt;t:block&gt;) to lay out two
           different HTML forms, and we're using the
           <a href="http://tapestry.apache.org/current/apidocs/org/apache/tapestry5/corelib/components/Delegate.html">
           Delegate</a> component (&lt;t:delegate&gt;)
           to decide which form to display. This technique
           presents a wizard-style form while keeping the the user on a single page.
        </p>
        <p>In this case, first a form is presented containing fields for
           dates and payment details. When that form is submitted, the page
           is redrawn with the form replaced by the booking details and a
           "Confirm" button.
        </p>
	</p:sidebar>

</html>
